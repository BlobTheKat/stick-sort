{Object.defineProperties(Array.prototype,{best:{enumerable:!1,value(t,s=-1/0){let e;const i=this.length;for(let h=0;h<i;h++){const i=this[h],r=t(i,h,this);r>=s&&(s=r,e=i)}return e}},mmap:{enumerable:!1,value(t){const s=this.length;for(let e=0;e<s;e++)this[e]=t(this[e]);return this}},bind:{enumerable:!1,value(t,s=-1){if((s>>>=0)>=this.length)return this.push(t);let e;for(;s<this.length;)e=this[s],this[s++]=t,t=e;return this.push(e)}},fire:{enumerable:!1,value(...t){for(const s of this)try{s(...t)}catch(t){Promise.reject(t)}}},mapFire:{enumerable:!1,value(...t){const s=new Array(this.length);for(const e of this)try{s.push(e(...t))}catch(t){Promise.reject(t),s.push(void 0)}return s}}}),Uint8Array.fromHex=function(t){const s=new Uint8Array(t.length>>>1);let e=1,i=0;for(let h=0;h<t.length;h++){const r=t.charCodeAt(h);r>47&&r<58?e=e<<4|r-48:r>64&&r<71?e=e<<4|r-55:r>96&&r<103&&(e=e<<4|r-87),256&e&&(s[i++]=e,e=1)}return s.slice(0,i)};const t="0123456789abcdef";Number.prototype.toHex=function(){return t[this>>>28]+t[this>>24&15]+t[this>>20&15]+t[this>>16&15]+t[this>>12&15]+t[this>>8&15]+t[this>>4&15]+t[15&this]},Number.formatData=t=>t<512?t.toFixed(0)+"B":t<524288?(t/1024).toFixed(1)+"KiB":t<536870912?(t/1048576).toFixed(1)+"MiB":t<549755813888?(t/1073741824).toFixed(1)+"GiB":(t/1099511627776).toFixed(1)+"TiB",Date.safestamp=(t=new Date)=>`${t.getYear()+1900}-${("0"+t.getMonth()).slice(-2)}-${("0"+t.getDate()).slice(-2)}-at-${("0"+t.getHours()).slice(-2)}-${("0"+t.getMinutes()).slice(-2)}-${("0"+t.getSeconds()).slice(-2)}`,Gamma.utils=t=>{t.screenshot=(t="image/png",s)=>new Promise((e=>requestAnimationFrame((()=>gl.canvas.toBlob(e,t,s)))));class s{x=0;y=0;sensitivity=.5;constructor(t,s,e){this.contents=t,this.width=s,this.height=e}scrollBarX=i;scrollBarY=i;get scrollbar(){return this.scrollBarY}set scrollbar(t){this.scrollBarX=this.scrollBarY=t}consumeInputs(t){const{x:s,y:e}=t.fromDelta(scrollDelta),i=this.sensitivity;scrollDelta.x=scrollDelta.y=0;const h=this.contents.width,r=this.contents.height;this.x=this.width>0?max(0,min(this.x+s*i,h-this.width)):min(0,max(this.x+s*i,-h-this.width)),this.y=this.height>0?max(0,min(this.y+e*i,r-this.height)):min(0,max(this.y+e*i,-r-this.height)),wheel.x=wheel.y=0;const l=this.contents;l&&((t=t.sub()).translate((l.xOffset??0)-this.x,(l.yOffset??0)-this.y),l.consumeInputs?.(t))}draw(t,...s){const e=this.contents;if(!e?.draw)return;const i=t.mask,h=t.sub();if(h.mask=128,h.drawRect(0,0,this.width,this.height),h.mask=15&i|16,h.translate((e.xOffset??0)-this.x,(e.yOffset??0)-this.y),this.contents.draw(h,...s),t.clearStencil(),this.scrollBarX&&this.height){const s=t.sub();s.translate(0,this.height),this.height>0&&s.scale(1,-1);const i=abs(this.width),h=i/e.width;h<1&&this.scrollBarX(s,abs(this.x)*h,i*h)}if(this.scrollBarY&&this.width){const s=t.sub();s.translate(this.width,0),s.multiply(0,1),this.width>0&&s.scale(1,-1);const i=abs(this.height),h=i/e.height;h<1&&this.scrollBarY(s,abs(this.y)*h,i*h)}}}t.Scrollable=(t,e=1,i=-1)=>new s(t,+e,+i);const e=t.vec4(.2),i=t.Scrollable.defaultScrollbar=(t,s,i)=>{t.shader=null,t.drawRect(s,0,i,.1,e)}};const s=document.createElement("a");globalThis.download=(t,e=t.name??("@"==t.type[0]?"file":t.type.split("/",1)[0]))=>{s.href=URL.createObjectURL(t),s.download=e,s.click(),URL.revokeObjectURL(s.href)}}